<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Strangers Again - Cinema</title>
    <link href="styles.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Waiting+for+the+Sunrise" rel="stylesheet" type="text/css" />


</head>

<body>
    <div id="lyrics">

        <!-- <div class="typewriter"> -->
        <!--     <h1>Strangers Again - Cinema</h1> -->
        <!-- </div> -->

        <div id="typedtext"></div>

        <audio id="audio" src="Strangers Again Lyrics by Cinema.mp3" autoplay></audio>
        <div id="warning" style="display: none;">
            <p>Auto-play was prevented. Please click the button below to start the audio.</p>
            <button id="playButton">Play Audio</button>
        </div>
        <div id="counter"></div>
        <br></br>
        <span class="word" data-text="I'd Be A Fool If I Couldn't See" data-time="6">
            I'd Be A Fool If I Couldn't See
        </span>
        <br></br>
        <span data-time="13" data-text="How Things Have Changed Between You And Me">
            How Things Have Changed Between You And Me
        </span>

        <br></br>

        <span data-time="18" data-text="Maybe We Try Just A Little Too Hard">
            Maybe We Try Just A Little Too Hard
        </span>
        <br></br>
        <span data-time="24" data-text="And Now We Are Strangers Again">
            And Now We Are Strangers Again
        </span>
        <br></br>
        <span data-time="30" data-text="I Kiss Your Lips But They Feel So Cold">
            I Kiss Your Lips But They Feel So Cold
        </span>
        <br></br>
        <span data-time="36" data-text="I Still Remember We Used To Hold">
            I Still Remember We Used To Hold
        </span>
        <br></br>
        <span data-time="41" data-text="On Those Cold And Lonely Nights We Make Love">
            On Those Cold And Lonely Nights We Make Love
        </span>
        <br></br>
        <span data-time="47" data-text="And Now We Are Strangers Again">
            And Now We Are Strangers Again
        </span>
        <br></br>
        <span data-time="54" data-text="Oh Lady, It's Hard To Believe">
            Oh Lady, It's Hard To Believe
        </span>
        <br></br>
        <span data-time="58" data-text="That There In Your Eyes, Stranger I See">
            That There In Your Eyes, Stranger I See
        </span>
        <br></br>
        <span data-time="65" data-text="And That The Only Song We Got Left To Play">
            And That The Only Song We Got Left To Play
        </span>
        <br></br>
        <span data-time="70" data-text="Are The Memories Of Yesterday">
            Are The Memories Of Yesterday
        </span>
        <br></br>
        <span data-time="76" data-text="I'd Be A Fool If I Couldn't See">
            I'd Be A Fool If I Couldn't See
        </span>
        <br></br>
        <span data-time="81" data-text="How Things Have Changed Between You And Me">
            How Things Have Changed Between You And Me
        </span>
        <br></br>
        <span data-time="86" data-text="Maybe We Try Just A Little Too Hard">
            Maybe We Try Just A Little Too Hard
        </span>
        <br></br>
        <span data-time="91" data-text="And Now We Are Strangers Again">
            And Now We Are Strangers Again
        </span>
        <br></br>
        <span data-time="121" data-text="Oh Lady, It's Hard To Believe">
            Oh Lady, It's Hard To Believe
        </span>
        <br></br>
        <span data-time="125" data-text="That There In Your Eyes, Stranger I See">
            That There In Your Eyes, Stranger I See
        </span>
        <br></br>
        <span data-time="131" data-text="And That The Only Song We Got Left To Play">
            And That The Only Song We Got Left To Play
        </span>
        <br></br>
        <span data-time="137" data-text="Are The Memories Of Yesterday">
            Are The Memories Of Yesterday
        </span>
        <br></br>
        <span data-time="142" data-text="I'd Be A Fool If I Couldn't See">
            I'd Be A Fool If I Couldn't See
        </span>
        <br></br>
        <span data-time="148" data-text="How Things Have Changed Between You And Me">
            How Things Have Changed Between You And Me
        </span>
        <br></br>
        <span data-time="154" data-text="Maybe We Try Just A Little Too Hard">
            Maybe We Try Just A Little Too Hard
        </span>
        <br></br>
        <span data-time="159" data-text="And Now We Are Strangers Again">
            And Now We Are Strangers Again
        </span>

        <script>
            function counter() {
                const counter = document.getElementById("counter");
                let count = 6;

                const countdown = setInterval(() => {
                    counter.textContent = count; // Update the div with the current count
                    count--;

                    if (count < 0) {
                        clearInterval(countdown); // Stop the countdown when it reaches 1
                        counter.textContent = "";
                    }
                }, 1000); // The countdown updates every 1000 milliseconds (1 second)

            }

            document.addEventListener("DOMContentLoaded", function () {
                const audio = document.getElementById("audio");
                audio.play().catch(error => {
                    console.log("Auto-play was prevented:", error);
                });
            });


            // start ------------------AUDIO-----------------------------------

            const audio = document.getElementById("audio");
            const lyrics = document.querySelectorAll("#lyrics span");
            const highlightedWords = new Set();


            audio.play().catch(error => {
                console.log("Auto-play was prevented:", error);
                document.getElementById("warning").style.display = "block";
                document.getElementById("playButton").addEventListener("click", () => {
                    audio.play();
                    counter();

                    document.getElementById("warning").style.display = "none";
                });
            })

            audio.addEventListener("timeupdate", function () {
                const currentTime = audio.currentTime;
                // console.log(audio.currentTime);
                lyrics.forEach((word, index) => {
                    const wordTime = parseFloat(word.getAttribute("data-time"));

                    const nextWordTime = index < lyrics.length - 1
                        ? parseFloat(lyrics[index + 1].getAttribute("data-time"))
                        : audio.duration; // If it's the last word, extend until the end of the audio

                    const duration = nextWordTime - wordTime; // Calculate duration for the animation

                    if (currentTime >= wordTime && currentTime < nextWordTime && !audio.paused) {
                        word.classList.add('word'); // Add the 'word' class to start the animation
                        word.style.animationDuration = `${duration}s`; // Set animation duration
                        highlightedWords.add(word);
                        // Calculate the progress of the animation
                        // setTimeout(() => {
                        //     word.classList.add('text-red');
                        // }, duration * 1000);

                    } else if (currentTime > wordTime) {
                        word.classList.remove('text-black');
                        word.classList.add('text-red');
                        word.classList.remove('word'); // Remove the 'word' class to stop the animation
                    } else {
                        // word.style.color = "black";
                        word.classList.add('text-black');
                        word.classList.remove('word'); // Remove the 'word' class to stop the animation
                        // highlightedWords.delete(word);
                    }
                });


                // lyrics.forEach(word => {
                //     const wordTime = parseFloat(word.getAttribute("data-time"));
                //
                //     if (highlightedWords.has(word)) {
                //         setTimeout(() => {
                //             word.style.color = "red";
                //         }, wordTime * 1000);
                //     }
                // })
            });


            audio.play(); // Start playback
            // end ------------------AUDIO-----------------------------------


            // set up text to print, each item in array is new line
            var aText = new Array(
                "Strangers Again - Cinema"
            );
            var iSpeed = 100; // time delay of print out
            var iIndex = 0; // start printing array at this posision
            var iArrLength = aText[0].length; // the length of the text array
            var iScrollAt = 20; // start scrolling up at this many lines

            var iTextPos = 0; // initialise text position
            var sContents = ''; // initialise contents variable
            var iRow; // initialise current row

            function typewriter() {
                sContents = ' ';
                iRow = Math.max(0, iIndex - iScrollAt);
                var destination = document.getElementById("typedtext");

                while (iRow < iIndex) {
                    sContents += aText[iRow++] + '<br />';
                }
                destination.innerHTML = sContents + aText[iIndex].substring(0, iTextPos) + "_";
                if (iTextPos++ === iArrLength) {
                    iTextPos = 0;
                    iIndex++;
                    if (iIndex !== aText.length) {
                        iArrLength = aText[iIndex].length;
                        setTimeout("typewriter()", 500);
                    }
                } else {
                    setTimeout("typewriter()", iSpeed);
                }
            }
            for (let i = 0; i < lyrics.length; i++) {
                lyrics[i].addEventListener("click", function () {
                    audio.currentTime = parseFloat(lyrics[i].getAttribute("data-time"));
                });
            }

            typewriter();

        </script>
    </div>
</body>

</html>
